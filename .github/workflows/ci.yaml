name: Continuous Integration

on:
    push:
    # pull_request: 
    #     types: [opened, reopened] 
    #     branches: "feature/**" 

jobs:
    build:
        runs-on: ubuntu-latest
        steps:
        -   
            name: Git Checkout
            uses: actions/checkout@v4
  
        -   name: Setup Java SDK
            uses: actions/setup-java@v4
            with:  
              distribution: 'temurin'
              java-version: '21'
              
        -   name: Unit tests
            run: mvn test

        -   name: Login to Docker Hub
            uses: docker/login-action@v3
            with: 
                username: ${{ secrets.DOCKERHUB_USERNAME }} 
                password: ${{ secrets.DOCKERHUB_TOKEN }} 

        -   name: Push to Registry  
            uses: docker/build-push-action@v6  
            with:  
                push: true 
                tags: ${{ secrets.DOCKERHUB_USERNAME }}/simple-api-java:latest
